SELECT v.COD_MUN_IBGE AS COD_MUN_IBGE, v.NOME_MUNICIPIO AS NOME_MUNICIPIO, v.UF AS UF, IF(v.NUMERO_PARTIDO = '95', 'VOTO BRANCO', IF(v.NUMERO_PARTIDO = '96', 'VOTO NULO', c.NOME_CANDIDATO)) AS NOME_CANDIDATO, v.NUMERO_CANDIDATO AS NUMERO_CANDIDATO, l.NUMERO_PARTIDO AS NUMERO_PARTIDO, IF(v.NUMERO_PARTIDO = '95', 'VOTO BRANCO', IF(v.NUMERO_PARTIDO = '96', 'VOTO NULO', l.SIGLA_PARTIDO)) AS SIGLA_PARTIDO, c.DESCRICAO_SEXO AS DESCRICAO_SEXO, c.DESCRICAO_GRAU_INSTRUCAO AS DESCRICAO_GRAU_INSTRUCAO, c.DESCRICAO_ESTADO_CIVIL AS DESCRICAO_ESTADO_CIVIL, c.DESCRICAO_COR_RACA AS DESCRICAO_COR_RACA, v.QTDE_VOTOS AS QTDE_VOTOS FROM (SELECT ANO_ELEICAO AS ANO_ELEICAO, COD_MUN_TSE AS COD_MUN_TSE, COD_MUN_IBGE AS COD_MUN_IBGE, NOME_MUNICIPIO AS NOME_MUNICIPIO, CODIGO_MICRO AS CODIGO_MICRO, NOME_MICRO AS NOME_MICRO, CODIGO_MESO AS CODIGO_MESO, NOME_MESO AS NOME_MESO, UF AS UF, NOME_UF AS NOME_UF, CODIGO_MACRO AS CODIGO_MACRO, NOME_MACRO AS NOME_MACRO, NUM_TURNO AS NUM_TURNO, DESCRICAO_ELEICAO AS DESCRICAO_ELEICAO, CODIGO_CARGO AS CODIGO_CARGO, DESCRICAO_CARGO AS DESCRICAO_CARGO, NUMERO_CANDIDATO AS NUMERO_CANDIDATO, ID_CANDIDATO, SUBSTRING(NUMERO_CANDIDATO, 1, 2) AS NUMERO_PARTIDO, MAX(ID_LEGENDA) AS ID_LEGENDA, SUM(QTDE_VOTOS) AS QTDE_VOTOS FROM votos_mun WHERE (p_cargo = '13') AND p_ano IN ('2016') GROUP BY 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18) as v LEFT JOIN candidatos as c ON v.ID_CANDIDATO = c.ID_CANDIDATO AND v.ANO_ELEICAO = c.ANO_ELEICAO LEFT JOIN legendas as l ON v.ID_LEGENDA = l.ID_LEGENDA AND v.ANO_ELEICAO = l.ANO_ELEICAO WHERE REGEXP_LIKE(LOWER(c.NOME_CANDIDATO), 'valdirene tavares dos santos') AND v.NUMERO_PARTIDO <> '97' AND v.NUMERO_PARTIDO <> '95' AND v.NUMERO_PARTIDO <> '96' AND c.COD_SIT_TOT_TURNO IN ('1', '2', '3') ORDER BY v.UF ASC, l.SIGLA_PARTIDO ASC, c.NOME_CANDIDATO ASC, v.COD_MUN_IBGE ASC